{"componentChunkName":"component---src-templates-blog-post-js","path":"/til/2019-11-22-react-helmet-nextjs/","result":{"data":{"site":{"siteMetadata":{"title":"TIL","author":"[Suho]","siteUrl":"https://gatsby-starter-bee.netlify.com","comment":{"disqusShortName":"","utterances":"angelxtry/blog-comment"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"a9a21ba3-fc25-5916-9bd2-7bde8968c186","excerpt":"메신저나 페이스북에 링크를 적었을 때 미리보기가 지원되는 기능을 추가하고 싶었다. 찾아보니 head에 meta tag를 넣으면 된다고. 그래서 작업삽질을 시작했다. 1. 일단 검색 react head meta tag 등의 키워드로 검색을 해보니, ,  등이 나왔다. 은 express 보안 패키지와 이름이 같아서 처음에는 보안 관련 패키지인줄 알았다. 조금 훑어보니 이 내가 원하는 그거더라. 그래서 사용하기로 결정. 2. 설치 3. 적용해볼까 현재 만들고 있는 프로젝트는 Next.js…","html":"<p>메신저나 페이스북에 링크를 적었을 때 미리보기가 지원되는 기능을 추가하고 싶었다.</p>\n<p>찾아보니 head에 meta tag를 넣으면 된다고.</p>\n<p>그래서 작업<del>삽질</del>을 시작했다.</p>\n<h2 id=\"1-일단-검색\" style=\"position:relative;\"><a href=\"#1-%EC%9D%BC%EB%8B%A8-%EA%B2%80%EC%83%89\" aria-label=\"1 일단 검색 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 일단 검색</h2>\n<p>react head meta tag 등의 키워드로 검색을 해보니, <code class=\"language-text\">react-meta-tags</code>, <code class=\"language-text\">react-helmet</code> 등이 나왔다.</p>\n<p><code class=\"language-text\">react-helmet</code>은 express 보안 패키지와 이름이 같아서 처음에는 보안 관련 패키지인줄 알았다.</p>\n<p>조금 훑어보니 <code class=\"language-text\">react-helmet</code>이 내가 원하는 그거더라. 그래서 사용하기로 결정.</p>\n<h2 id=\"2-설치\" style=\"position:relative;\"><a href=\"#2-%EC%84%A4%EC%B9%98\" aria-label=\"2 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 설치</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">npm i react<span class=\"token operator\">-</span>helmet</code></pre></div>\n<h2 id=\"3-적용해볼까\" style=\"position:relative;\"><a href=\"#3-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%BC%EA%B9%8C\" aria-label=\"3 적용해볼까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 적용해볼까</h2>\n<p>현재 만들고 있는 프로젝트는 Next.js로 되어있다.</p>\n<p>그래서 다른 페이지에도 한 번에 적용할 수 있도록 <code class=\"language-text\">_app.js</code>에 적용을 시도했다.</p>\n<script src=\"https://gist.github.com/angelxtry/05688625f06c975df569b6dd2a60152d.js\"></script>\n<p>짠~ 잘되더라. 그래서 그냥 끝!인줄 알았다.</p>\n<p>SSR에서 meta tag가 적용됐는지 확인해보려면 postman으로 html을 받아보라고 하더라고.</p>\n<p>받아봤는데 없네. 열심히 적어놓은 meta tag가 없어.</p>\n<p>내가 지금 보는 웹페이지에는 있는데 postman으로 받은 데이터에는 없어.</p>\n<p>아… SSR이 안됐구나.</p>\n<p>이리저리 검색하다가 <a href=\"https://salgum1114.github.io/nextjs/2019-05-06-nextjs-static-website-1/\">Next.js로 정적 웹사이트 만들기 - 1. Next.js 구조</a> 글을 찾았다.</p>\n<p>내용을 보니 <code class=\"language-text\">_document.js</code>\u001b에 정적으로 meta tag를 넣을 수 있는 방법이 있었다.</p>\n<script src=\"https://gist.github.com/angelxtry/e78ed51fb4821a765931f4d78ecce943.js\"></script>\n<p>오! 잘 된다! postman으로 실행해봐도 title, meta가 잘 들어가 있는 것이 확인된다.</p>\n<p>그럼 <code class=\"language-text\">react-helmet</code>은 왜 쓰는거지?</p>\n<p>아무생각 없이 가져다 쓰려고 했는데 이제 보니 meta 등의 tag를 동적으로 변경하기 위해 react-helmet을 사용하나보다.</p>\n<p>그리고 계속 refresh 하다보니 다음과 같은 경고가 계속 발생하고 있었다.</p>\n<p><code class=\"language-text\">Warning: &lt;title&gt; should not be used in _document.js&#39;s &lt;Head&gt;. https://err.sh/next.js/no-document-title</code></p>\n<p>찾아보니 title은 _app.js에 넣으라고 하네.</p>\n<p>다시 _app.js 파일에 meta tag들을 다 모아놓고 _document.js 파일을 수정한다.</p>\n<script src=\"https://gist.github.com/angelxtry/ee04a501d6e32e7cb17fd8d7f0a3172b.js\"></script>\n<p><code class=\"language-text\">Helmet\b.renderStatic()</code>을 실행하면 link, meta, script, style, title과 htmlAttributes, bodyAttributes가 만들어진다.</p>\n<p>이것은 _app.js\u001c에 작성한 항목들인 것 같다.</p>\n<p>render() 함수에서 이것들을 풀고 react component를 꺼내서 각 항목에 전달한다.</p>\n<p>아이고 참 어렵넹.</p>\n<p><code class=\"language-text\">_app.js</code>를 맨 앞에 써 놓은 것 처럼 작성하면 다음과 같은 에러가 발생한다.</p>\n<p><code class=\"language-text\">Error: &quot;MyDocument.getInitialProps()&quot; should resolve to an object with a &quot;html&quot; prop set with a valid html string</code></p>\n<p>그래서 _app.js를 다음과 같이 변경한다.</p>\n<script src=\"https://gist.github.com/angelxtry/8922dc0abb6347f6bf6a764b94e2b90c.js\"></script>\n<p>이렇게 글까지 썼지만 아직도 잘 모르겠는 부분이 많다 ㅠㅠ</p>\n<p>갈길이 멀구나 ㅋㅋㅋㅋ 그래도 재미있으니 다행이다.</p>","frontmatter":{"title":"Next.js에 react-helmet 적용","date":"November 22, 2019"}}},"pageContext":{"slug":"/til/2019-11-22-react-helmet-nextjs/","previous":{"fields":{"slug":"/development/2019-11-22-react-helmet-nextjs/"},"frontmatter":{"title":"Next.js에 react-helmet 적용","category":"development"}},"next":{"fields":{"slug":"/development/2019-11-27-Utc-data-lookup-by-local-date/"},"frontmatter":{"title":"UTC로 저장된 데이터를 Local Date로 조회하기","category":"development"}}}},"staticQueryHashes":["3128451518","96099027"]}